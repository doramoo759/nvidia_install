#!/bin/bash
# ============================================================
# Ubuntuìš© ctop ìµœì‹  ë²„ì „ ìë™ ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸
# ============================================================

set -e

echo "ğŸš€ ctop ìµœì‹  ë²„ì „ ì„¤ì¹˜ ì‹œì‘..."

# ----------------------------
# 1ï¸âƒ£ GitHub APIë¥¼ í†µí•´ ìµœì‹  ë²„ì „ í™•ì¸
# ----------------------------
LATEST_TAG=$(curl -s https://api.github.com/repos/bcicen/ctop/releases/latest | grep '"tag_name":' | sed -E 's/.*"v([^"]+)".*/\1/')
CTOP_BIN="ctop-${LATEST_TAG}-linux-amd64"

echo "[1/4] ìµœì‹  ë²„ì „ í™•ì¸: v${LATEST_TAG}"

# ----------------------------
# 2ï¸âƒ£ ë‹¤ìš´ë¡œë“œ
# ----------------------------
echo "[2/4] ctop ë‹¤ìš´ë¡œë“œ ì¤‘..."
wget -q "https://github.com/bcicen/ctop/releases/download/v${LATEST_TAG}/${CTOP_BIN}" -O ctop

# ----------------------------
# 3ï¸âƒ£ ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
# ----------------------------
echo "[3/4] ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬..."
chmod +x ctop

# ----------------------------
# 4ï¸âƒ£ /usr/local/binìœ¼ë¡œ ì´ë™
# ----------------------------
echo "[4/4] /usr/local/binìœ¼ë¡œ ì´ë™ ì¤‘..."
sudo mv ctop /usr/local/bin/

# ----------------------------
# 5ï¸âƒ£ ì„¤ì¹˜ í™•ì¸
# ----------------------------
echo "âœ… ctop ì„¤ì¹˜ ì™„ë£Œ!"
echo "ë²„ì „ í™•ì¸: $(ctop --version)"
echo "ì‹¤í–‰: ctop"
